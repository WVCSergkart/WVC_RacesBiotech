<?xml version="1.0" encoding="utf-8" ?>
<Defs>

  <ThinkTreeDef>
	<defName>WVC_XenotypesAndGenes_WalkingCorpse</defName>
	<thinkRoot Class="ThinkNode_Priority">
	  <subNodes>
		<!-- Keep lying down if we have to -->
		<li Class="ThinkNode_ConditionalMustKeepLyingDown">
		  <subNodes>
			<!-- Do a queued job if possible -->
			<li Class="ThinkNode_QueuedJob">
			  <inBedOnly>true</inBedOnly>
			</li>

			<!-- Keep lying down -->
			<li Class="JobGiver_KeepLyingDown" />
		  </subNodes>
		</li>
		
		<li Class="ThinkNode_Subtree">
		  <treeDef>Downed</treeDef>
		</li>
		<li Class="ThinkNode_Subtree">
		  <treeDef>BurningResponse</treeDef>
		</li>
		<li Class="ThinkNode_Subtree">
		  <treeDef>MentalStateCritical</treeDef>
		</li>
		
		<!-- React to close melee threat -->
		<li Class="JobGiver_ReactToCloseMeleeThreat" />

		<!-- Do a queued job -->
		<li Class="ThinkNode_QueuedJob" />

		<!-- Wild animals dig out if no path to map edge and starving -->
		<li Class="ThinkNode_ConditionalHasFaction">
		  <invert>true</invert>
		  <subNodes>
			<li Class="ThinkNode_ConditionalStarving">
			  <subNodes>
				<li Class="ThinkNode_ConditionalBodySize">
				  <min>0.7</min>
				  <subNodes>
					<li Class="ThinkNode_Subtree">
					  <treeDef>DigOutIfCannotReachMapEdge</treeDef>
					</li>
				  </subNodes>
				</li>
			  </subNodes>
			</li>
		  </subNodes>
		</li>
		
		<!-- Leave if timed out -->
		<li Class="ThinkNode_ConditionalExitTimedOut">
		  <subNodes>
			<li Class="ThinkNode_Tagger">
			  <tagToGive>Misc</tagToGive>
			  <subNodes>
				<li Class="JobGiver_ExitMapRandom">
				  <defaultLocomotion>Walk</defaultLocomotion>     
				</li>
			  </subNodes>
			</li>
		  </subNodes>
		</li>

		<!-- Mental state non critical -->
		<li Class="ThinkNode_Subtree">
		  <treeDef>MentalStateNonCritical</treeDef>
		</li>

		<!-- Forced goto -->
		<li Class="ThinkNode_ConditionalForcedGoto">
		  <subNodes>
			<li Class="ThinkNode_Tagger">
			  <tagToGive>Misc</tagToGive>
			  <subNodes>
				<li Class="JobGiver_ForcedGoto" />
			  </subNodes>
			</li>
		  </subNodes>
		</li>

		<!-- Behavior when roped -->
		<li Class="ThinkNode_Subtree">
		  <treeDef>RopedPawn</treeDef>
		</li>

		<!-- Lord directives -->
		<li Class="ThinkNode_Subtree">
		  <treeDef>LordDuty</treeDef>
		</li>

		<!-- Insertion hook for modders -->
		<li Class="ThinkNode_SubtreesByTag">
		  <insertTag>Animal_PreMain</insertTag>
		</li>

		<!-- Wild animals leave map in some conditions -->
		<li Class="ThinkNode_ConditionalHasFaction">
		  <invert>true</invert>
		  <subNodes>
			<li Class="JobGiver_ExitMapRandom">
			  <defaultLocomotion>Walk</defaultLocomotion>
			</li>
		  </subNodes>
		</li>

		<!-- Lay eggs you need to -->
		<li Class="JobGiver_LayEgg" />

		<!-- Tame animal -->
		<li Class="ThinkNode_ConditionalOfPlayerFaction">
		  <subNodes>

			<li Class="ThinkNode_ConditionalRequireCapacities">
			  <requiredCapacities>
				<li>Manipulation</li>
			  </requiredCapacities>
			  <subNodes>

				<li Class="ThinkNode_Tagger">
					<tagToGive>TrainedAnimalBehavior</tagToGive>
					<subNodes>
						<li Class="JobGiver_AIFightEnemies">
							<targetAcquireRadius>65</targetAcquireRadius>
							<targetKeepRadius>72</targetKeepRadius>
						</li>
						<li Class="JobGiver_AIGotoNearestHostile" />
					</subNodes>
				</li>

			  </subNodes>
			</li>

			<!-- Take care of critical needs (below rescue - so heroic!)-->
			
			<li Class="ThinkNode_Tagger">
			  <tagToGive>RestingForMedicalReasons</tagToGive>
			  <subNodes>
				<li Class="JobGiver_PatientGoToBed" />
			  </subNodes>
			</li>
			
			<li Class="JobGiver_SeekAllowedArea" />
			<li Class="JobGiver_SeekSafeTemperature" />
			
		  </subNodes>
		</li>
		
		<!-- Satisfy basic needs -->
		<li Class="ThinkNode_Subtree">
		  <treeDef>SatisfyBasicNeeds</treeDef>
		</li>

		<!-- Insertion hook for modders -->
		<li Class="ThinkNode_SubtreesByTag">
		  <insertTag>Animal_PreWander</insertTag>
		</li>
		
		<!-- Tame animal: wander near colony if possible -->
		<li Class="ThinkNode_ConditionalOfPlayerFaction">
		  <subNodes>
			<li Class="ThinkNode_Tagger">
			  <tagToGive>Idle</tagToGive>
			  <subNodes>
				<!-- Wander near your current position if in hostile map -->
				<li Class="ThinkNode_ConditionalAnyEnemyInHostileMap">
				  <subNodes>
					<li Class="JobGiver_WanderAnywhere">
					  <maxDanger>None</maxDanger>
					  <ticksBetweenWandersRange>120~240</ticksBetweenWandersRange>
					</li>
				  </subNodes>
				</li>

				<!-- Wander near colony -->
				<li Class="WVC_XenotypesAndGenes.JobGiver_WanderNearTarget">
				  <targetDefName>WVC_XenotypesAndGenes_WalkingCorpseTotem</targetDefName>
				</li>
				<!-- <li Class="JobGiver_WanderAnywhere"> -->
				  <!-- <maxDanger>None</maxDanger> -->
				  <!-- <ticksBetweenWandersRange>120~240</ticksBetweenWandersRange>     -->
				<!-- </li> -->
			  </subNodes>
			</li>
		  </subNodes>
		</li>
		
		<!-- Of neutral faction: rest and then exit the map -->
		<li Class="ThinkNode_ConditionalNonPlayerNonHostileFaction">
		  <subNodes>
			<li Class="JobGiver_ExitMapBest">
			  <defaultLocomotion>Sprint</defaultLocomotion>
			</li>
		  </subNodes>
		</li>
		
		<!-- Wander -->
		<li Class="ThinkNode_Tagger">
		  <tagToGive>Idle</tagToGive>
		  <subNodes>
			<li Class="JobGiver_WanderAnywhere">
			  <maxDanger>None</maxDanger>
			  <ticksBetweenWandersRange>120~240</ticksBetweenWandersRange>    
			</li>
		  </subNodes>
		</li>

		<li Class="JobGiver_IdleError"/>
	  </subNodes>
	</thinkRoot>
  </ThinkTreeDef>

</Defs>
